machine:
    node:
        version: 6.3.1
    python:
        version: 2.7.9

dependencies:
    pre:
        # ensures pre-commit dependencies are properly installed; see https://github.com/pre-commit/pre-commit/issues/280
        - pip install --upgrade pip
    override:
        - pip install pre-commit
        - npm install -g bower
        - npm install
        - bower install
    post:
        - pre-commit install

test:
    override:
        - pre-commit run --all-files
        - npm test
    post:
        # Collect code coverage artifacts; see https://github.com/kategengler/ember-cli-code-coverage
        # Depends on environment variable `COVERAGE` being set in CI
        # You can also run locally: `COVERAGE=true ember test`
        - mkdir -p $CIRCLE_ARTIFACTS/coverage
        - cp -r coverage/* $CIRCLE_ARTIFACTS/coverage
        # Collect xunit artifact; see https://circleci.com/docs/test-metadata#js
        # Depends on `testem.json` having:
        # ```js
        # "reporter": "xunit",
        # "report_file": "tests/reports/QUnit.xml",
        # ```
        - mkdir -p $CIRCLE_TEST_REPORTS/QUnit
        - cp tests/reports/* $CIRCLE_TEST_REPORTS/QUnit/
