machine:
    node:
        version: 4.2.4
    python:
        version: 2.7.9

dependencies:
    pre:
        # ensures pre-commit dependencies are properly installed; see https://github.com/pre-commit/pre-commit/issues/280
        - pip install --upgrade pip
    override:
        - pip install pre-commit
        - npm install -g bower
        - npm install
        - bower install
    post:
        - pre-commit install

test:
    override:
        - pre-commit run --all-files
        - npm test
    post:
        # Collect xunit artifact; see https://circleci.com/docs/test-metadata#js
        # Depends on `testem.json` having:
        # ```js
        # "reporter": "xunit",
        # "report_file": "tests/reports/QUnit.xml",
        # ```
        - mkdir -p $CIRCLE_TEST_REPORTS/QUnit
        - cp tests/reports/* $CIRCLE_TEST_REPORTS/QUnit/
